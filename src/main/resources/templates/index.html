<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<link th:href="@{favicon.ico}" rel="shortcut icon"/>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>Das beste Spiel</title>
</head>
<body>
<script th:src="@{/js/ConnectionHandler.js}" type="text/javascript"></script>
<link th:href="@{/css/styles.css}" rel="stylesheet"/>

<div>Waiting for two players!</div>
<div>players count: <span id="playersNumber"></span></div>
<div id="announcement" style="display: none">Got two players, let's begin!</div>
<button id="connectButton">Connect</button>
<button id="disconnectButton">Disconnect</button>
<div>Text output</div>
<div id="textOutput">...</div>
<div class="game-board" id="gameBoard" style="display: none"></div>

<script>
    const connectionHandler = new ConnectionHandler();

    for (let i = 0; i < 3; i++) {
        for (let j = 0; j < 3; j++) {
            const boxId = "box_" + i + j;
            $("#gameBoard").append("<div class=\"box\" id=" + boxId + "></div>");
            $("#" + boxId).click(() => {
                connectionHandler.sendFieldClickedMessage(i, j);
            });
        }
    }

    $("#connectButton").click(() => {
        connectionHandler.connectToServer(
            () => {
                setOutputText("connected");
                $("#gameBoard").css("display", "grid");
                $("#connectButton").prop("disabled", true);
            }
        );

    });

    $("#disconnectButton").click(() => {
        connectionHandler.disconnect(
            () => {
                setOutputText("disconnected");
                $("#gameBoard").css("display", "none");
            }
        );
    });

    function setOutputText(text) {
        return () => {
            $("#textOutput").html(text);
        };
    }


</script>
</body>
</html>
